name: btc_recent_blocks
type: overwrite
migrations:
- name: btc_recent_blocks
  sql: |-
    CREATE OR REPLACE VIEW spiceai.datasets.btc_recent_blocks AS (SELECT number, hash, size, stripped_size, weight, version, merkle_root, "timestamp", nonce, bits, coinbase_param, transaction_count
    FROM backfillpostgres.public.btc_blocks
    WHERE "timestamp" > UNIX_TIMESTAMP()-30*60 -- Blocks from 30 minutes ago, ~3 blocks
    ORDER BY number DESC
    )

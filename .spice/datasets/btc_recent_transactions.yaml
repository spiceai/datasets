name: btc_recent_transactions
type: overwrite
migrations:
- name: btc_recent_transactions
  sql: |-
    CREATE OR REPLACE VIEW spiceai.datasets.btc_recent_transactions AS (SELECT hash, size, virtual_size, version, lock_time, block_hash, block_number, block_timestamp, input_count, output_count, input_value, output_value, is_coinbase, fee
    FROM backfillpostgres.public.btc_transactions
    WHERE "block_timestamp" > UNIX_TIMESTAMP()-30*60 -- Blocks from 30 minutes ago, ~3 blocks
    ORDER BY block_number DESC
    )

name: btc_recent_transaction_outputs
type: overwrite
migrations:
- name: btc_recent_transaction_outputs
  sql: |-
    CREATE OR REPLACE VIEW "@spiceai".datasets.btc_recent_transaction_outputs AS (SELECT transaction_hash, index, script_asm, script_hex, type, addresses, "value", block_number, block_hash, block_timestamp
    FROM internal.btc.postgres.transaction_outputs
    WHERE "block_timestamp" > UNIX_TIMESTAMP()-30*60 -- Blocks from 30 minutes ago, ~3 blocks
    ORDER BY block_number DESC
    )
